<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Resume Analyzer</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --dark-color: #1f2937;
            --light-bg: #f8fafc;
        }

        body {
            background: linear-gradient(135deg, var(--light-bg) 0%, #e2e8f0 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 10px;
            padding: 12px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #059669);
            border: none;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e5e7eb;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(37, 99, 235, 0.15);
        }

        .file-upload-area {
            border: 3px dashed #d1d5db;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            background: #ffffff;
        }

        .file-upload-area:hover {
            border-color: var(--primary-color);
            background: #f8fafc;
        }

        .file-upload-area.dragover {
            border-color: var(--success-color);
            background: #f0fdf4;
        }

        .progress-container {
            display: none;
            margin-top: 20px;
        }

        .progress {
            height: 10px;
            border-radius: 10px;
            background-color: #e5e7eb;
        }

        .progress-bar {
            border-radius: 10px;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
        }

        .alert {
            border: none;
            border-radius: 12px;
            padding: 15px 20px;
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-size: 24px;
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 60px 0;
            margin-bottom: 50px;
        }

        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        .email-section {
            background: #f8fafc;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 40px 0;
            }
            
            .card {
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">
                <i class="fas fa-robot me-2"></i>AI Resume Analyzer
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="#features">Features</a>
                <a class="nav-link" href="#analyzer">Analyzer</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-4">Intelligent Resume Analysis</h1>
            <p class="lead mb-4">Upload resumes, analyze against job descriptions, and get AI-powered insights instantly</p>
            <a href="#analyzer" class="btn btn-light btn-lg">
                <i class="fas fa-play me-2"></i>Start Analyzing
            </a>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="container mb-5">
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center p-4">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h5>Detailed Scoring</h5>
                    <p class="text-muted">Get percentage-based matching scores and detailed feedback for each candidate</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center p-4">
                    <div class="feature-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h5>Automated Emails</h5>
                    <p class="text-muted">Send personalized response emails to candidates automatically</p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100 text-center p-4">
                    <div class="feature-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h5>AI-Powered Analysis</h5>
                    <p class="text-muted">Advanced AI models analyze resumes against job requirements with high accuracy</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Analyzer Section -->
    <section id="analyzer" class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card">
                    <div class="card-header bg-primary text-white text-center py-4">
                        <h3 class="mb-0"><i class="fas fa-upload me-2"></i>Resume Analyzer</h3>
                    </div>
                    <div class="card-body p-4">
                        <!-- Alert Messages -->
                        <div id="alertContainer"></div>

                        <form id="uploadForm" enctype="multipart/form-data">
                            <!-- Job Description -->
                            <div class="mb-4">
                                <label for="job_description" class="form-label fw-bold">
                                    <i class="fas fa-briefcase me-2"></i>Job Description *
                                </label>
                                <textarea class="form-control" id="job_description" name="job_description" rows="8" 
                                          placeholder="Paste the complete job description here..." required></textarea>
                                <div class="form-text">Provide detailed job requirements for better analysis</div>
                            </div>

                            <!-- API Configuration -->
                            <div class="row mb-4">
                                <div class="col-md-8">
                                    <label for="api_key" class="form-label fw-bold">
                                        <i class="fas fa-key me-2"></i>GROQ API Key *
                                    </label>
                                    <input type="password" class="form-control" id="api_key" name="api_key" 
                                           placeholder="Enter your GROQ API key" required>
                                    <div class="form-text">
                                        <a href="https://console.groq.com/keys" target="_blank" class="text-decoration-none">
                                            Get your free API key from GROQ
                                        </a>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label for="model_option" class="form-label fw-bold">
                                        <i class="fas fa-cog me-2"></i>Model
                                    </label>
                                    <select class="form-select" id="model_option" name="model_option">
                                        <option value="llama3-70b-8192">Llama3 70B (Recommended)</option>
                                        <option value="llama3-8b-8192">Llama3 8B (Faster)</option>
                                        <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
                                        <option value="gemma-7b-it">Gemma 7B</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Advanced Settings -->
                            <div class="mb-4">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="temperature" class="form-label fw-bold">
                                            <i class="fas fa-thermometer-half me-2"></i>Temperature
                                        </label>
                                        <input type="range" class="form-range" id="temperature" name="temperature" 
                                               min="0" max="1" step="0.1" value="0.0">
                                        <div class="d-flex justify-content-between">
                                            <small>0.0 (Precise)</small>
                                            <small id="tempValue">0.0</small>
                                            <small>1.0 (Creative)</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- File Upload -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">
                                    <i class="fas fa-folder me-2"></i>Upload Resume Folder *
                                </label>
                                <div class="file-upload-area" id="fileUploadArea">
                                    <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                    <h5>Drag & Drop folder with PDFs here</h5>
                                    <p class="text-muted mb-3">or click to browse folders</p>
                                    <input type="file" class="form-control d-none" id="pdf_files" name="pdf_files" 
                                           multiple webkitdirectory directory accept=".pdf" required>
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('pdf_files').click()">
                                            <i class="fas fa-folder-open me-2"></i>Choose Folder
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="enableFileMode()">
                                            <i class="fas fa-file me-2"></i>Choose Individual Files
                                        </button>
                                    </div>
                                </div>
                                <div class="form-text mt-2">
                                    <small><strong>Folder Mode:</strong> Select a folder containing PDF resumes</small><br>
                                    <small><strong>File Mode:</strong> Select individual PDF files</small>
                                </div>
                                <div id="fileList" class="mt-3"></div>
                            </div>

                            <!-- Submit Button -->
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                                    <i class="fas fa-rocket me-2"></i>Analyze Resumes
                                </button>
                            </div>

                            <!-- Progress Bar -->
                            <div class="progress-container">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>Processing resumes...</span>
                                    <span id="progressText">0%</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                                </div>
                            </div>
                        </form>

                        <!-- Results Section -->
                        <div id="resultsSection" class="mt-5" style="display: none;">
                            <hr>
                            <h4 class="text-primary mb-4">
                                <i class="fas fa-chart-bar me-2"></i>Analysis Results
                            </h4>
                            <div id="resultsContent"></div>
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <a href="/download_results" class="btn btn-success w-100">
                                        <i class="fas fa-download me-2"></i>Download CSV Report
                                    </a>
                                </div>
                                <div class="col-md-6">
                                    <a href="/results" class="btn btn-primary w-100">
                                        <i class="fas fa-eye me-2"></i>View Detailed Results
                                    </a>
                                </div>
                            </div>

                            <!-- Email Section -->
                            <div class="email-section mt-4">
                                <h5 class="text-primary mb-3">
                                    <i class="fas fa-envelope me-2"></i>Send Automated Emails
                                </h5>
                                <form id="emailForm">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="sender_email" class="form-label">Sender Email</label>
                                            <input type="email" class="form-control" id="sender_email" name="sender_email" 
                                                   placeholder="your-email@gmail.com" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="sender_password" class="form-label">App Password</label>
                                            <input type="password" class="form-control" id="sender_password" name="sender_password" 
                                                   placeholder="App-specific password" required>
                                            <div class="form-text">
                                                <small>Use app-specific password for Gmail. 
                                                <a href="https://myaccount.google.com/apppasswords" target="_blank">Generate here</a></small>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-paper-plane me-2"></i>Send Emails to Candidates
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div class="container">
            <p class="mb-0">&copy; 2024 AI Resume Analyzer. Built with ❤️ and AI</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        // Temperature slider update
        document.getElementById('temperature').addEventListener('input', function() {
            document.getElementById('tempValue').textContent = this.value;
        });

        // File upload handling
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileInput = document.getElementById('pdf_files');
        const fileList = document.getElementById('fileList');
        let isFileMode = false;

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('dragover');
            
            // Check if items are files or directories
            const items = e.dataTransfer.items;
            if (items) {
                const files = [];
                const promises = [];
                
                for (let i = 0; i < items.length; i++) {
                    const item = items[i].webkitGetAsEntry();
                    if (item) {
                        promises.push(traverseFileTree(item, files));
                    }
                }
                
                Promise.all(promises).then(() => {
                    handleFiles(files);
                });
            } else {
                // Fallback for browsers that don't support webkitGetAsEntry
                handleFiles(e.dataTransfer.files);
            }
        });

        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        // Function to traverse file tree for drag and drop folders
        function traverseFileTree(item, files) {
            return new Promise((resolve) => {
                if (item.isFile) {
                    item.file((file) => {
                        if (file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')) {
                            files.push(file);
                        }
                        resolve();
                    });
                } else if (item.isDirectory) {
                    const dirReader = item.createReader();
                    dirReader.readEntries((entries) => {
                        const promises = entries.map(entry => traverseFileTree(entry, files));
                        Promise.all(promises).then(() => resolve());
                    });
                } else {
                    resolve();
                }
            });
        }

        // Enable file mode (individual file selection)
        function enableFileMode() {
            isFileMode = !isFileMode;
            const fileInput = document.getElementById('pdf_files');
            const uploadArea = document.querySelector('.file-upload-area h5');
            const description = document.querySelector('.file-upload-area p');
            
            if (isFileMode) {
                fileInput.removeAttribute('webkitdirectory');
                fileInput.removeAttribute('directory');
                uploadArea.textContent = 'Drag & Drop PDF files here';
                description.textContent = 'or click to browse individual files';
                document.querySelector('.btn-outline-secondary').innerHTML = '<i class="fas fa-folder me-2"></i>Switch to Folder Mode';
            } else {
                fileInput.setAttribute('webkitdirectory', '');
                fileInput.setAttribute('directory', '');
                uploadArea.textContent = 'Drag & Drop folder with PDFs here';
                description.textContent = 'or click to browse folders';
                document.querySelector('.btn-outline-secondary').innerHTML = '<i class="fas fa-file me-2"></i>Choose Individual Files';
            }
            
            // Clear current selection
            fileInput.value = '';
            fileList.innerHTML = '';
        }

        function handleFiles(files) {
            fileList.innerHTML = '';
            
            // Filter PDF files
            const pdfFiles = Array.from(files).filter(file => 
                file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')
            );
            
            if (pdfFiles.length > 0) {
                const totalSize = pdfFiles.reduce((sum, file) => sum + file.size, 0);
                
                // Create summary card
                const summaryCard = document.createElement('div');
                summaryCard.className = 'alert alert-info d-flex justify-content-between align-items-center';
                summaryCard.innerHTML = `
                    <div>
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>${pdfFiles.length} PDF files selected</strong>
                        <small class="d-block text-muted">Total size: ${(totalSize / 1024 / 1024).toFixed(2)} MB</small>
                    </div>
                    <button type="button" class="btn btn-sm btn-outline-secondary" onclick="toggleFileList()">
                        <i class="fas fa-eye me-1"></i>View Details
                    </button>
                `;
                fileList.appendChild(summaryCard);
                
                // Create detailed file list (initially hidden)
                const detailsDiv = document.createElement('div');
                detailsDiv.id = 'fileDetails';
                detailsDiv.style.display = 'none';
                
                const ul = document.createElement('ul');
                ul.className = 'list-group';
                
                pdfFiles.forEach(file => {
                    const li = document.createElement('li');
                    li.className = 'list-group-item d-flex justify-content-between align-items-center';
                    
                    // Extract folder path if available
                    const path = file.webkitRelativePath || file.name;
                    const displayPath = path.includes('/') ? path : file.name;
                    
                    li.innerHTML = `
                        <div>
                            <i class="fas fa-file-pdf text-danger me-2"></i>
                            <span class="fw-bold">${file.name}</span>
                            ${file.webkitRelativePath ? `<br><small class="text-muted">${file.webkitRelativePath}</small>` : ''}
                        </div>
                        <span class="badge bg-primary rounded-pill">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
                    `;
                    ul.appendChild(li);
                });
                
                detailsDiv.appendChild(ul);
                fileList.appendChild(detailsDiv);
            } else {
                const noFilesAlert = document.createElement('div');
                noFilesAlert.className = 'alert alert-warning';
                noFilesAlert.innerHTML = `
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    No PDF files found. Please select a folder containing PDF files or individual PDF files.
                `;
                fileList.appendChild(noFilesAlert);
            }
        }

        function toggleFileList() {
            const fileDetails = document.getElementById('fileDetails');
            const toggleBtn = document.querySelector('[onclick="toggleFileList()"]');
            
            if (fileDetails.style.display === 'none') {
                fileDetails.style.display = 'block';
                toggleBtn.innerHTML = '<i class="fas fa-eye-slash me-1"></i>Hide Details';
            } else {
                fileDetails.style.display = 'none';
                toggleBtn.innerHTML = '<i class="fas fa-eye me-1"></i>View Details';
            }
        }

        // Form submission
        document.getElementById('uploadForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const submitBtn = document.getElementById('submitBtn');
            const progressContainer = document.querySelector('.progress-container');
            const progressBar = document.querySelector('.progress-bar');
            const progressText = document.getElementById('progressText');
            
            // Show progress
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processing...';
            progressContainer.style.display = 'block';
            
            try {
                // Simulate progress
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 90) progress = 90;
                    progressBar.style.width = progress + '%';
                    progressText.textContent = Math.round(progress) + '%';
                }, 1000);

                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });

                clearInterval(progressInterval);
                progressBar.style.width = '100%';
                progressText.textContent = '100%';

                const result = await response.json();

                if (response.ok) {
                    showAlert('success', result.message);
                    displayResults(result.results);
                    document.getElementById('resultsSection').style.display = 'block';
                } else {
                    showAlert('danger', result.error || 'An error occurred');
                }
            } catch (error) {
                showAlert('danger', 'Network error: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-rocket me-2"></i>Analyze Resumes';
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                    progressBar.style.width = '0%';
                }, 2000);
            }
        });

        // Email form submission
        document.getElementById('emailForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const submitBtn = e.target.querySelector('button[type="submit"]');
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Sending...';
            
            try {
                const response = await fetch('/send_emails', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (response.ok) {
                    showAlert('success', result.message);
                } else {
                    showAlert('danger', result.error || 'Failed to send emails');
                }
            } catch (error) {
                showAlert('danger', 'Network error: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i>Send Emails to Candidates';
            }
        });

        function showAlert(type, message) {
            const alertContainer = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type} alert-dismissible fade show`;
            alert.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertContainer.appendChild(alert);
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        function displayResults(results) {
            const resultsContent = document.getElementById('resultsContent');
            
            if (!results || results.length === 0) {
                resultsContent.innerHTML = '<p class="text-muted">No results to display.</p>';
                return;
            }

            // Calculate summary statistics
            const total = results.length;
            const perfect = results.filter(r => r.is_perfect === true || r.is_perfect === 'True').length;
            const okay = results.filter(r => r.is_okay === true || r.is_okay === 'True').length;
            
            // Calculate average score
            const scores = results.map(r => {
                const score = r['Matching Score in percentage'];
                if (typeof score === 'string') {
                    return parseInt(score.replace('%', '')) || 0;
                }
                return parseInt(score) || 0;
            });
            const avgScore = scores.reduce((a, b) => a + b, 0) / scores.length;

            resultsContent.innerHTML = `
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card text-center bg-primary text-white">
                            <div class="card-body">
                                <h3>${total}</h3>
                                <p class="mb-0">Total Resumes</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-success text-white">
                            <div class="card-body">
                                <h3>${perfect}</h3>
                                <p class="mb-0">Perfect Matches</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-warning text-white">
                            <div class="card-body">
                                <h3>${okay}</h3>
                                <p class="mb-0">Good Matches</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center bg-info text-white">
                            <div class="card-body">
                                <h3>${Math.round(avgScore)}%</h3>
                                <p class="mb-0">Avg Score</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead class="table-dark">
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Score</th>
                                <th>Status</th>
                                <th>Strong Zone</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${results.map(result => `
                                <tr>
                                    <td>${result.Name || 'Unknown'}</td>
                                    <td>${result.email || 'N/A'}</td>
                                    <td>
                                        <span class="badge ${getScoreBadgeClass(result['Matching Score in percentage'])}">
                                            ${result['Matching Score in percentage'] || '0%'}
                                        </span>
                                    </td>
                                    <td>
                                        ${result.is_perfect ? '<span class="badge bg-success">Perfect</span>' : 
                                          result.is_okay ? '<span class="badge bg-warning">Good</span>' : 
                                          '<span class="badge bg-secondary">Needs Work</span>'}
                                    </td>
                                    <td>${result['strong zone'] || 'N/A'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function getScoreBadgeClass(score) {
            const numScore = parseInt(String(score).replace('%', '')) || 0;
            if (numScore >= 80) return 'bg-success';
            if (numScore >= 60) return 'bg-warning';
            return 'bg-danger';
        }

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>